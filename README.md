# 나스닥 레버리지 투자 백테스팅 시뮬레이터

이 프로젝트는 나스닥 레버리지 ETF(QLE, TQQQ)를 대상으로 투자했을 경우의 성과를 확인할 수 있는 백테스팅 시뮬레이터입니다. 나스닥의 과거 데이터를 활용하여 1972년부터 QLD와 TQQQ 같은 레버리지 ETF를 사용한 시뮬레이션이 가능합니다. 이를 통해 시장 변동성에 따른 투자 성과를 확인할 수 있습니다.

## 주요 기능

- 나스닥 레버리지 ETF 백테스팅 (1972년부터)
- QLD, TQQQ와 같은 2배, 3배 레버리지 투자 전략 시뮬레이션
- 매월 일정 금액 적립식 매수 시뮬레이션
- 과거 시장 변동 (닷컴버블, 금융위기) 동안의 투자 성과 확인
- 현금 보유와 레버리지 ETF에 투자했을 때의 비교

## 실행 방법

이 프로젝트는 `nasdaq_investment_simulation.py` 파일을 실행하면 됩니다:

```bash
python nasdaq_investment_simulation.py
```

필요한 패키지가 설치되어 있지 않을 경우, 아래 명령어를 사용하여 설치하세요:

```bash
pip install pandas matplotlib numpy xlsxwriter
```

### 오류 해결

프로젝트 실행 시 오류가 발생한다면, 아래 파일들을 참고하세요:

- `nasdaq_data_collection.py`: 데이터 파일이 없을 경우 이 파일을 실행하여 데이터를 수집합니다. (`nasdaq_daily_returns.xlsx` 파일이 `output` 폴더에 있어야 합니다)

## 출력 결과

프로그램이 실행되면 시뮬레이션 결과가 출력됩니다. 두 레버리지 비율에 따른 최종 자산 금액과 수익률을 확인할 수 있습니다:

```bash
========================================
- 현금 보유했을 경우 최종 금액: 52,400,000원
========================================
- 2배 레버리지를 매달 100만원씩 적립식 매수했을 경우:
  - 최종 금액: 126,500,000원
  - 최종 수익률: 141.23% (2.41배)
========================================
- 3배 레버리지를 매달 100만원씩 적립식 매수했을 경우:
  - 최종 금액: 230,700,000원
  - 최종 수익률: 340.45% (4.40배)
========================================
```

![investment_vs_asset_value](https://github.com/user-attachments/assets/077b3e6b-99bf-4bf9-bf0d-a98b8798ee64)


![nasdaq_index_comparison](https://github.com/user-attachments/assets/f4ca3829-e1f4-4566-8e70-e030a113d1d6)


자세한 데이터는 `output/investment_simulation.xlsx`에서 확인하세요.

## 파일 생성

- `output/nasdaq_index_comparison.png`: 나스닥 지수와 두 레버리지 투자 지수를 비교하는 차트
- `output/investment_vs_asset_value.png`: 총 투자 금액과 두 레버리지 자산 가치를 비교하는 차트
- `output/investment_simulation.xlsx`: 매월 투자 성과와 자산 변동을 기록한 엑셀 파일

## 코드 설명

이 시뮬레이터는 아래와 같은 단계를 통해 투자 백테스팅을 진행합니다:

1. **데이터 불러오기**: `nasdaq_daily_returns.xlsx` 파일에서 나스닥 일간 데이터를 불러옵니다.
2. **레버리지 설정**: 입력받은 레버리지 비율을 기반으로 투자 시뮬레이션을 진행합니다.
3. **매월 적립식 매수 시뮬레이션**: 각 월별로 일정 금액을 투자한 후, 레버리지 지수에 따라 자산 변동을 기록합니다.
4. **수익률 계산**: 투자 종료 시점에서 총 투자 금액과 자산 가치를 비교하여 최종 수익률을 계산합니다.
5. **결과 출력**: 최종 자산 금액과 수익률을 출력하고, 결과를 엑셀 파일로 저장합니다.

## 주요 기능 세부 설명

- **현금 보유와 레버리지 비교**: 현금 보유 시와 레버리지 ETF에 투자했을 때의 결과를 비교하여, 어떤 전략이 더 효율적이었는지 확인할 수 있습니다.
- **과거 시장 변동 반영**: 닷컴버블, 금융위기 등 과거 대규모 시장 변동성에 따른 투자 성과를 확인할 수 있습니다.
- **엑셀 파일 저장**: 시뮬레이션 결과는 `investment_simulation.xlsx` 파일로 저장되며, 이를 통해 투자 기간 동안의 자산 변동을 추적할 수 있습니다.

## 문의사항

프로젝트 관련 문의는 리포지토리의 이슈를 통해 남겨주시기 바랍니다.
